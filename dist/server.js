/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/server/controllers/builds.ts":
/*!******************************************!*\
  !*** ./src/server/controllers/builds.ts ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.builds = void 0;\nvar axios_1 = __webpack_require__(/*! axios */ \"axios\");\nvar db_1 = __webpack_require__(/*! ../db */ \"./src/server/db.ts\");\nexports.builds = {\n    fetchByBuildType: function (buildType) { return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, db_1.default(\"\\n    SELECT *\\n    FROM builds\\n    WHERE build_type = '\" + buildType + \"'\\n    ORDER BY id DESC\\n  \")];\n                case 1: return [2 /*return*/, _a.sent()];\n            }\n        });\n    }); },\n    getMasterUrl: function () { return __awaiter(void 0, void 0, void 0, function () {\n        var result, build, uses_unity_cloud_build, url, version, buildTargetName, PROJECT, shareUrl, response, detailsUrl;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, exports.builds.fetchByBuildType(\"StandaloneLinux64\")];\n                case 1:\n                    result = _a.sent();\n                    build = result[0];\n                    uses_unity_cloud_build = build.uses_unity_cloud_build;\n                    if (!uses_unity_cloud_build) return [3 /*break*/, 4];\n                    version = build.version;\n                    buildTargetName = \"masters-of-conquest-headless\";\n                    PROJECT = \"masters-of-conquest-master\";\n                    shareUrl = \"https://build-api.cloud.unity3d.com/api/v1/orgs/\" + process.env.UNITY_ORGANIZATION + \"/projects/\" + PROJECT + \"/buildtargets/\" + buildTargetName + \"/builds/\" + version + \"/share\";\n                    return [4 /*yield*/, axios_1.default.get(shareUrl, {\n                            headers: { Authorization: \"Basic \" + process.env.TOKEN_UNITY_CLOUD },\n                        })];\n                case 2:\n                    response = _a.sent();\n                    detailsUrl = \"https://build-api.cloud.unity3d.com/api/v1/shares/\" + response.data.shareid;\n                    return [4 /*yield*/, axios_1.default.get(detailsUrl, {\n                            headers: { Authorization: \"Basic \" + process.env.TOKEN_UNITY_CLOUD },\n                        })];\n                case 3:\n                    response = _a.sent();\n                    url = response.data.links.artifacts[0].files[0].href;\n                    console.log(url);\n                    return [3 /*break*/, 5];\n                case 4:\n                    url = build.url;\n                    _a.label = 5;\n                case 5: return [2 /*return*/, {\n                        build: build,\n                        url: url,\n                    }];\n            }\n        });\n    }); },\n};\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/controllers/builds.ts?");

/***/ }),

/***/ "./src/server/controllers/deploy.ts":
/*!******************************************!*\
  !*** ./src/server/controllers/deploy.ts ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.deploy = void 0;\nvar axios_1 = __webpack_require__(/*! axios */ \"axios\");\nvar path = __webpack_require__(/*! path */ \"path\");\nvar spawn = __webpack_require__(/*! child_process */ \"child_process\").spawn;\nvar builds_1 = __webpack_require__(/*! ./builds */ \"./src/server/controllers/builds.ts\");\nprocess.env.NODE_TLS_REJECT_UNAUTHORIZED = \"0\";\nvar child;\nexports.deploy = {\n    deploy: function (callback) { return __awaiter(void 0, void 0, void 0, function () {\n        var script, result, build, version, url, uses_unity_cloud_build, PROJECT, shareUrl, response, detailsUrl, url_1, i_1, i_2;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    console.log(\"deploy\");\n                    script = path.dirname(__filename) + \"/bash/\" + \"deploy.sh\";\n                    return [4 /*yield*/, builds_1.builds.fetchByBuildType(\"StandaloneLinux64\")];\n                case 1:\n                    result = _a.sent();\n                    build = result[0];\n                    version = build.version, url = build.url, uses_unity_cloud_build = build.uses_unity_cloud_build;\n                    if (!uses_unity_cloud_build) return [3 /*break*/, 5];\n                    PROJECT = \"masters-of-conquest-master\";\n                    shareUrl = \"https://build-api.cloud.unity3d.com/api/v1/orgs/\" + process.env.UNITY_ORGANIZATION + \"/projects/\" + PROJECT + \"/buildtargets/masters-of-conquest-headless/builds/\" + version + \"/share\";\n                    return [4 /*yield*/, axios_1.default.get(shareUrl, {\n                            headers: { Authorization: \"Basic \" + process.env.TOKEN_UNITY_CLOUD },\n                        })];\n                case 2:\n                    response = _a.sent();\n                    if (!response) return [3 /*break*/, 4];\n                    detailsUrl = \"https://build-api.cloud.unity3d.com/api/v1/shares/\" + response.data.shareid;\n                    return [4 /*yield*/, axios_1.default.get(detailsUrl, {\n                            headers: { Authorization: \"Basic \" + process.env.TOKEN_UNITY_CLOUD },\n                        })];\n                case 3:\n                    response = _a.sent();\n                    url_1 = response.data.links.download_primary.href;\n                    console.log(\"url\", url_1);\n                    child = spawn(\"sh\", [script, url_1]);\n                    child.stdout.on(\"data\", function (data) {\n                        console.log(\"stdout: \" + data);\n                        callback(\"\" + data);\n                    });\n                    i_1 = 0;\n                    child.stderr.on(\"data\", function (data) {\n                        // console.log('stderr: ' + data);\n                        if (i_1 % 32 == 0) {\n                            if (data.includes(\"%\")) {\n                                data = (\"\" + data).replace(\".\", \"\");\n                                callback(data);\n                            }\n                        }\n                        i_1 += 1;\n                    });\n                    child.on(\"close\", function (code) {\n                        console.log(\"child process exited with code \" + code);\n                        callback(\"\" + code);\n                    });\n                    _a.label = 4;\n                case 4: return [3 /*break*/, 6];\n                case 5:\n                    console.log(\"url\", url);\n                    child = spawn(\"sh\", [script, url]);\n                    child.stdout.on(\"data\", function (data) {\n                        console.log(\"stdout: \" + data);\n                        callback(\"\" + data);\n                    });\n                    i_2 = 0;\n                    child.stderr.on(\"data\", function (data) {\n                        // console.log('stderr: ' + data);\n                        if (i_2 % 32 == 0) {\n                            if (data.includes(\"%\")) {\n                                data = (\"\" + data).replace(\".\", \"\");\n                                callback(data);\n                            }\n                        }\n                        i_2 += 1;\n                    });\n                    child.on(\"close\", function (code) {\n                        console.log(\"child process exited with code \" + code);\n                        callback(\"\" + code);\n                    });\n                    _a.label = 6;\n                case 6: return [2 /*return*/, 0];\n            }\n        });\n    }); },\n    deploy_without_callback: function () { return __awaiter(void 0, void 0, void 0, function () {\n        var message, url, params, result, build, version, buildTargetName, PROJECT, shareUrl, response, detailsUrl, script, child;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    console.log(\"deploy_withouth_callback\");\n                    message = \"master-client-node MasterClientDeployEvent fired\";\n                    url = process.env.SERVER_ADDRESS_HYPEWIZARD + \"/api/alert_mobile_user\";\n                    params = {\n                        api_token: process.env.TOKEN_HYPEWIZARD_OVERRIDE,\n                        user_id: 2,\n                        message: message,\n                    };\n                    return [4 /*yield*/, axios_1.default.get(url, {\n                            params: params,\n                        })];\n                case 1:\n                    result = _a.sent();\n                    return [4 /*yield*/, builds_1.builds.fetchByBuildType(\"StandaloneLinux64\")];\n                case 2:\n                    result = _a.sent();\n                    build = result[0];\n                    version = build.version;\n                    buildTargetName = \"masters-of-conquest-headless\";\n                    PROJECT = \"masters-of-conquest-master\";\n                    shareUrl = \"https://build-api.cloud.unity3d.com/api/v1/orgs/\" + process.env.UNITY_ORGANIZATION + \"/projects/\" + PROJECT + \"/buildtargets/\" + buildTargetName + \"/builds/\" + version + \"/share\";\n                    return [4 /*yield*/, axios_1.default.get(shareUrl, {\n                            headers: { Authorization: \"Basic \" + process.env.TOKEN_UNITY_CLOUD },\n                        })];\n                case 3:\n                    response = _a.sent();\n                    detailsUrl = \"https://build-api.cloud.unity3d.com/api/v1/shares/\" + response.data.shareid;\n                    return [4 /*yield*/, axios_1.default.get(detailsUrl, {\n                            headers: { Authorization: \"Basic \" + process.env.TOKEN_UNITY_CLOUD },\n                        })];\n                case 4:\n                    response = _a.sent();\n                    url = response.data.links.artifacts[0].files[0].href;\n                    console.log(url);\n                    script = path.dirname(__filename) + \"/bash/\" + \"deploy.sh\";\n                    child = spawn(\"sh\", [script, url], {\n                        detached: true,\n                        stdio: \"inherit\",\n                    });\n                    child.on(\"close\", function (code) {\n                        console.log(\"child process exited with code \" + code);\n                    });\n                    return [2 /*return*/, 0];\n            }\n        });\n    }); },\n    inspect: function (callback) { return __awaiter(void 0, void 0, void 0, function () {\n        var script, child;\n        return __generator(this, function (_a) {\n            console.log(\"inspect\");\n            script = path.dirname(__filename) + \"/bash/\" + \"inspect.sh\";\n            child = spawn(\"sh\", [script]);\n            child.stdout.on(\"data\", function (data) {\n                console.log(\"stdout: \" + data);\n                callback(\"\");\n                callback(\"\" + data);\n            });\n            child.stderr.on(\"data\", function (data) {\n                // console.log('stderr: ' + data);\n                callback(\"\" + data);\n            });\n            child.on(\"close\", function (code) {\n                console.log(\"child process exited with code \" + code);\n                // callback(`${code}`);\n            });\n            return [2 /*return*/, 0];\n        });\n    }); },\n    log: function (callback) { return __awaiter(void 0, void 0, void 0, function () {\n        var script, child;\n        return __generator(this, function (_a) {\n            console.log(\"log\");\n            script = path.dirname(__filename) + \"/bash/\" + \"log.sh\";\n            child = spawn(\"sh\", [script]);\n            child.stdout.on(\"data\", function (data) {\n                console.log(\"stdout: \" + data);\n                callback(\"\" + data);\n            });\n            child.stderr.on(\"data\", function (data) {\n                // console.log('stderr: ' + data);\n                callback(\"\" + data);\n            });\n            child.on(\"close\", function (code) {\n                console.log(\"child process exited with code \" + code);\n                // callback(`${code}`);\n            });\n            return [2 /*return*/, 0];\n        });\n    }); },\n    dump_log: function (callback) { return __awaiter(void 0, void 0, void 0, function () {\n        var script, child;\n        return __generator(this, function (_a) {\n            console.log(\"dump_log\");\n            script = path.dirname(__filename) + \"/bash/\" + \"dump_log.sh\";\n            child = spawn(\"sh\", [script]);\n            child.stdout.on(\"data\", function (data) {\n                console.log(\"stdout: \" + data);\n                callback(\"\" + data);\n            });\n            child.stderr.on(\"data\", function (data) {\n                // console.log('stderr: ' + data);\n                callback(\"\" + data);\n            });\n            child.on(\"close\", function (code) {\n                console.log(\"child process exited with code \" + code);\n                // callback(`${code}`);\n            });\n            return [2 /*return*/, 0];\n        });\n    }); },\n    info: function (callback) { return __awaiter(void 0, void 0, void 0, function () {\n        var buildUrl;\n        return __generator(this, function (_a) {\n            buildUrl = process.env.API_PLATFORM_ENDPOINT + \"/api/builds?build_type=StandaloneLinux64\";\n            axios_1.default\n                .get(buildUrl, {\n                headers: { \"X-OverrideToken\": \"\" + process.env.TOKEN_OVERRIDE_PLAY_PLATFORM },\n            })\n                .then(function (response) {\n                var version = response.data.data.builds[0].version;\n                callback(\"\" + version);\n            })\n                .catch(function (error) {\n                console.log(error);\n            });\n            return [2 /*return*/, 0];\n        });\n    }); },\n    start: function (callback) { return __awaiter(void 0, void 0, void 0, function () {\n        var script, child;\n        return __generator(this, function (_a) {\n            console.log(\"start\");\n            script = path.dirname(__filename) + \"/bash/\" + \"start.sh\";\n            child = spawn(\"sh\", [script]);\n            child.stdout.on(\"data\", function (data) {\n                console.log(\"stdout: \" + data);\n                callback(\"\");\n                callback(\"\" + data);\n            });\n            child.stderr.on(\"data\", function (data) {\n                // console.log('stderr: ' + data);\n                callback(\"\" + data);\n            });\n            child.on(\"close\", function (code) {\n                console.log(\"child process exited with code \" + code);\n                // callback(`${code}`);\n            });\n            return [2 /*return*/, 0];\n        });\n    }); },\n    stop: function (callback) { return __awaiter(void 0, void 0, void 0, function () {\n        var script, child;\n        return __generator(this, function (_a) {\n            console.log(\"stop\");\n            script = path.dirname(__filename) + \"/bash/\" + \"stop.sh\";\n            child = spawn(\"sh\", [script]);\n            child.stdout.on(\"data\", function (data) {\n                console.log(\"stdout: \" + data);\n                callback(\"\");\n                callback(\"\" + data);\n            });\n            child.stderr.on(\"data\", function (data) {\n                // console.log('stderr: ' + data);\n                callback(\"\" + data);\n            });\n            child.on(\"close\", function (code) {\n                console.log(\"child process exited with code \" + code);\n                // callback(`${code}`);\n            });\n            return [2 /*return*/, 0];\n        });\n    }); },\n};\n// { id: '232',\n//   build_type: 'StandaloneLinux64',\n//   version: '15',\n//   caption: 'masters-of-conquest-headless.zip',\n//   url:\n//    'https://unitycloud-build-user-svc-live-build.s3.amazonaws.com/2485260/93996fe3-b080-483d-995e-722c9984012e/masters-of-conquest-headless-15/masters-of-conquest-headless.zip?AWSAccessKeyId=AKIAI6ZGSQWNDMF7X33A&Expires=1530669280&Signature=vXFGbcHenLNrGfuxvcBpmC3PZCs%3D&response-content-disposition=attachment%3B%20filename%3Dplay-entertainment-llc-masters-of-conquest-masters-of-conquest-headless-15.zip&response-content-type=application%2Foctet-stream',\n//   created_at: '2018-07-04T01:24:41.226Z',\n//   updated_at: '2018-07-04T01:24:41.226Z' }\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/controllers/deploy.ts?");

/***/ }),

/***/ "./src/server/db.ts":
/*!**************************!*\
  !*** ./src/server/db.ts ***!
  \**************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar Client = __webpack_require__(/*! pg */ \"pg\").Client;\nvar db;\nfunction connectDatabase() {\n    var _this = this;\n    if (!db) {\n        var client_1 = new Client({\n            database: process.env.DATABASE_NAME,\n            host: process.env.DATABASE_HOST,\n            port: process.env.DATABASE_PORT,\n            user: process.env.DATABASE_USER,\n            password: process.env.DATABASE_PASSWORD\n        });\n        client_1.connect();\n        db = function (sql, cb) { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, client_1.query(sql, cb)];\n                case 1: return [2 /*return*/, (_a.sent()).rows];\n            }\n        }); }); };\n    }\n    return db;\n}\nexports.default = connectDatabase();\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/db.ts?");

/***/ }),

/***/ "./src/server/reporting.ts":
/*!*********************************!*\
  !*** ./src/server/reporting.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.reportError = void 0;\nvar bugsnag = __webpack_require__(/*! bugsnag */ \"bugsnag\");\nbugsnag.register(process.env.BUGSNAG_KEY, {\n    notifyReleaseStages: [\"production\"]\n    // appVersion: `${process.env.HEROKU_RELEASE_VERSION} (${process.env.HEROKU_SLUG_COMMIT})`,\n    // metaData: {\n    //     dyno: {\n    //         commit: process.env.HEROKU_SLUG_COMMIT,\n    //         version: process.env.HEROKU_RELEASE_VERSION,\n    //         createdAt: process.env.HEROKU_RELEASE_CREATED_AT,\n    //         appId: process.env.HEROKU_APP_ID\n    //     }\n    // }\n});\nvar reportError = function (error) {\n    bugsnag.notify(error);\n};\nexports.reportError = reportError;\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/reporting.ts?");

/***/ }),

/***/ "./src/server/routes/api.ts":
/*!**********************************!*\
  !*** ./src/server/routes/api.ts ***!
  \**********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar express = __webpack_require__(/*! express */ \"express\");\nvar router = express.Router();\nvar path = __webpack_require__(/*! path */ \"path\");\nvar bodyParser = __webpack_require__(/*! body-parser */ \"body-parser\");\nvar cookieParser = __webpack_require__(/*! cookie-parser */ \"cookie-parser\");\nvar deploy_1 = __webpack_require__(/*! ../controllers/deploy */ \"./src/server/controllers/deploy.ts\");\nvar builds_1 = __webpack_require__(/*! ../controllers/builds */ \"./src/server/controllers/builds.ts\");\nvar asyncErrorHandler = function (fn) { return function (req, res, next) {\n    return fn(req, res, next).catch(next);\n}; };\nvar enforceEmptyQuery = function (req, res, next) {\n    if (req.query && req.query.length)\n        res\n            .status(400)\n            .send(\"This endpoint doesn't expect any query parameters, but you provided \" + JSON.stringify(req.querys) + \".\");\n    else\n        next();\n};\nvar enforceEmptyBody = function (req, res, next) {\n    if (req.body && req.body.length)\n        res\n            .status(400)\n            .send(\"This endpoint doesn't expect any content in its request body, but you provided \" + JSON.stringify(req.body) + \".\");\n    else\n        next();\n};\nvar authenticate = asyncErrorHandler(function (req, res, next) { return __awaiter(void 0, void 0, void 0, function () {\n    var cookie;\n    return __generator(this, function (_a) {\n        console.log(\"authenticate\");\n        console.log(req.headers);\n        console.log(req.headers[\"x-overridetoken\"]);\n        if (req.headers[\"x-overridetoken\"] === process.env.TOKEN_OVERRIDE_SELF) {\n            console.log(\"pass\");\n            next();\n        }\n        else {\n            if (!req.cookies) {\n                return [2 /*return*/, res.status(403).json({\n                        code: 1\n                    })];\n            }\n            cookie = req.cookies.cookie;\n            if (!cookie) {\n                return [2 /*return*/, res.status(403).json({\n                        code: 1\n                    })];\n            }\n            next();\n        }\n        return [2 /*return*/];\n    });\n}); });\nrouter.use(bodyParser.json());\nrouter.use(cookieParser());\n// curl http://0.0.0.0:3000/api/deploy\n// curl --header \"X-OverrideToken: efc192fd369a5bf2db5fcacbeb037442\" http://0.0.0.0:3000/api/deploy\n// curl --header \"X-OverrideToken: efc192fd369a5bf2db5fcacbeb037442\" http://master.playentertainment.online/api/deploy\nrouter.get(\"/deploy\", authenticate, asyncErrorHandler(function (req, res) { return __awaiter(void 0, void 0, void 0, function () {\n    var response;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0: return [4 /*yield*/, deploy_1.deploy.deploy_without_callback()];\n            case 1:\n                response = _a.sent();\n                res.status(200).json({\n                    code: 0,\n                    data: {}\n                });\n                return [2 /*return*/];\n        }\n    });\n}); }));\nrouter.get(\"/get_master_url\", authenticate, asyncErrorHandler(function (req, res) { return __awaiter(void 0, void 0, void 0, function () {\n    var _a, _b;\n    return __generator(this, function (_c) {\n        switch (_c.label) {\n            case 0:\n                _b = (_a = res.status(200)).json;\n                return [4 /*yield*/, builds_1.builds.getMasterUrl()];\n            case 1:\n                _b.apply(_a, [_c.sent()]);\n                return [2 /*return*/];\n        }\n    });\n}); }));\nrouter.get(\"/test\", function (req, res) {\n    var spawn = __webpack_require__(/*! child_process */ \"child_process\").spawn;\n    var script = path.dirname(__filename) + \"/server/bash/\" + \"hi.sh\";\n    var child = spawn(\"sh\", [script]);\n    child.stdout.on(\"data\", function (data) {\n        console.log(\"stdout: \" + data);\n    });\n    child.stderr.on(\"data\", function (data) {\n        console.log(\"stderr: \" + data);\n    });\n    child.on(\"close\", function (code) {\n        console.log(\"child process exited with code \" + code);\n    });\n    return res.status(200).send({});\n});\nexports.default = router;\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/routes/api.ts?");

/***/ }),

/***/ "./src/server/routes/forms.ts":
/*!************************************!*\
  !*** ./src/server/routes/forms.ts ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar bodyParser = __webpack_require__(/*! body-parser */ \"body-parser\");\nvar express = __webpack_require__(/*! express */ \"express\");\nvar router = express.Router();\nvar cookieParser = __webpack_require__(/*! cookie-parser */ \"cookie-parser\");\nvar asyncErrorHandler = function (fn) { return function (req, res, next) {\n    return fn(req, res, next).catch(next);\n}; };\nvar authenticate = asyncErrorHandler(function (req, res, next) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        next();\n        return [2 /*return*/];\n    });\n}); });\nrouter.use(bodyParser.json());\nrouter.use(cookieParser());\nrouter.post('/login', function (req, res) {\n    var _a = req.body, user = _a.user, password = _a.password;\n    console.log(req.body);\n    if (user === process.env.PASSWORD && password === process.env.PASSWORD) {\n        res.cookie('cookie', 'PLAY_COOKIE');\n        return res.json({\n            session: {\n                redirectTo: '/dashboard',\n                isAuthorized: true\n            }\n        });\n    }\n    else {\n        return res.json({\n            session: {\n                redirectTo: '/dashboard',\n                isAuthorized: false\n            }\n        });\n    }\n});\nexports.default = router;\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/routes/forms.ts?");

/***/ }),

/***/ "./src/server/server.ts":
/*!******************************!*\
  !*** ./src/server/server.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\n__webpack_require__(/*! dotenv */ \"dotenv\").config();\nvar socket_1 = __webpack_require__(/*! ./socket */ \"./src/server/socket.ts\");\nvar compression = __webpack_require__(/*! compression */ \"compression\");\nvar path = __webpack_require__(/*! path */ \"path\");\n;\nvar fs = __webpack_require__(/*! fs */ \"fs\");\nvar express = __webpack_require__(/*! express */ \"express\");\nvar serveIndex = __webpack_require__(/*! serve-index */ \"serve-index\");\nvar api_1 = __webpack_require__(/*! ./routes/api */ \"./src/server/routes/api.ts\");\nvar forms_1 = __webpack_require__(/*! ./routes/forms */ \"./src/server/routes/forms.ts\");\nvar app = express();\napp.use(express.static('public'));\napp.use(compression());\napp.use('/api', api_1.default);\napp.use('/forms', forms_1.default);\napp.use(\"/files\", express.static(\"masters-of-conquest-headless\"), serveIndex(\"masters-of-conquest-headless\", { icons: true }));\napp.get('*', function (req, res) {\n    res.sendFile('index.html', { root: path.join(__dirname, process.env.PATH_PUBLIC) });\n});\n///////////////////////////////////////////////////////////////////////////////\n// SOCKET\n///////////////////////////////////////////////////////////////////////////////\nvar server;\nvar http = __webpack_require__(/*! http */ \"http\");\nvar https = __webpack_require__(/*! https */ \"https\");\nif (true) {\n    var privateKey = fs.readFileSync(__dirname + '/certs/dev/key.pem', 'utf8');\n    var certificate = fs.readFileSync(__dirname + '/certs/dev/cert.pem', 'utf8');\n    var credentials = {\n        key: privateKey,\n        cert: certificate\n    };\n    server = https.createServer(credentials, app);\n}\nelse {}\n// SSL\nsocket_1.helpers.initialize(server);\n//\n// NO SSL\n// const http = require('http');\n// const server = http.createServer(app);\n// socket.initialize(server);\n//\nvar port = process.env.PORT || 3000;\nvar host = process.env.NODE_HOST;\nserver.listen(port, host, function (err) {\n    var url = \"https://\" + host + \":\" + port;\n    if (err)\n        console.error(\"==> \\uD83D\\uDE2D  OMG!!! \" + err);\n    console.info(\"==> \\uD83C\\uDF0E  Listening at \" + url + \" \" + \"development\");\n});\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/server.ts?");

/***/ }),

/***/ "./src/server/socket.ts":
/*!******************************!*\
  !*** ./src/server/socket.ts ***!
  \******************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.helpers = exports.socketEmit = void 0;\nvar socket;\nvar reporting = __webpack_require__(/*! ./reporting */ \"./src/server/reporting.ts\");\nvar WebSocket = __webpack_require__(/*! ws */ \"ws\");\nvar _ = __webpack_require__(/*! lodash */ \"lodash\");\nvar deploy_1 = __webpack_require__(/*! ./controllers/deploy */ \"./src/server/controllers/deploy.ts\");\nvar sockets = {};\nvar sockets_game = {};\nvar sockets_dashboard = {};\nvar heartbeat;\nvar uuid = __webpack_require__(/*! uuid */ \"uuid\");\nvar socketEmit = function (ws, payload) { return ws.send(JSON.stringify(payload)); };\nexports.socketEmit = socketEmit;\nexports.helpers = {\n    initialize: function (server) {\n        if (!socket) {\n            var wss = new WebSocket.Server({\n                server: server\n            });\n            wss.on(\"connection\", function connection(ws, req) {\n                ws.id = uuid.v4();\n                console.log(ws.id);\n                sockets[ws.id] = ws;\n                ws.on(\"message\", function (payload) {\n                    payload = JSON.parse(payload);\n                    exports.helpers.parse(ws, payload);\n                    // console.log('payload : ', payload);\n                });\n                ws.on(\"error\", function (error) {\n                    reporting.reportError(error);\n                });\n                ws.on(\"close\", function () {\n                    delete sockets[ws.id];\n                    if (sockets_game.hasOwnProperty(ws.id)) {\n                        console.log(\"stopping heartbeat\");\n                        clearInterval(heartbeat);\n                        console.log(heartbeat);\n                        delete sockets_game[ws.id];\n                    }\n                    if (sockets_dashboard.hasOwnProperty(ws.id)) {\n                        delete sockets_dashboard[ws.id];\n                    }\n                });\n            });\n            socket = wss;\n        }\n        return socket;\n    },\n    parse: function (ws, payload) { return __awaiter(void 0, void 0, void 0, function () {\n        var id, ws_to, callback, _a;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _a = payload[\"action\"];\n                    switch (_a) {\n                        case \"join\": return [3 /*break*/, 1];\n                        case \"subscribe\": return [3 /*break*/, 2];\n                        case \"update_dashboard\": return [3 /*break*/, 3];\n                        case \"ping_dashboard\": return [3 /*break*/, 4];\n                        case \"ping_api_server\": return [3 /*break*/, 5];\n                        case \"info_master_client\": return [3 /*break*/, 6];\n                        case \"deploy_master_client\": return [3 /*break*/, 8];\n                        case \"inspect_master_client\": return [3 /*break*/, 10];\n                        case \"log_master_client\": return [3 /*break*/, 12];\n                        case \"dump_log_master_client\": return [3 /*break*/, 14];\n                        case \"start_master_client\": return [3 /*break*/, 16];\n                        case \"stop_master_client\": return [3 /*break*/, 18];\n                    }\n                    return [3 /*break*/, 20];\n                case 1:\n                    exports.socketEmit(ws, {\n                        identifier: ws.id\n                    });\n                    return [3 /*break*/, 20];\n                case 2:\n                    console.log(\"subscribe\");\n                    console.log(payload[\"from\"], payload[\"channel\"]);\n                    if (payload[\"channel\"] === \"client-dashboard\") {\n                        sockets_dashboard[ws.id] = ws;\n                        exports.socketEmit(ws, {\n                            heartbeat: true\n                        });\n                    }\n                    return [3 /*break*/, 20];\n                case 3:\n                    // console.log(payload[\"from\"], payload[\"channel\"], payload[\"data\"]);\n                    // payload[\"data\"] = JSON.parse(payload[\"data\"]);\n                    _.forEach(sockets_dashboard, function (client, id) {\n                        console.log(id);\n                        if (client.readyState === WebSocket.OPEN) {\n                            exports.socketEmit(client, {\n                                heartbeat: true,\n                                payload: payload[\"data\"]\n                            });\n                        }\n                    });\n                    return [3 /*break*/, 20];\n                case 4:\n                    console.log(\"ping_dashboard\", payload[\"from\"], payload[\"channel\"]);\n                    _.forEach(sockets_dashboard, function (client, id) {\n                        console.log(id);\n                        if (client.readyState === WebSocket.OPEN) {\n                            exports.socketEmit(client, {\n                                callback: true\n                            });\n                        }\n                    });\n                    return [3 /*break*/, 20];\n                case 5:\n                    console.log(\"ping_api_server\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    exports.socketEmit(ws_to, {\n                        callback: true\n                    });\n                    return [3 /*break*/, 20];\n                case 6:\n                    console.log(\"info_master_client\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    callback = function (data) {\n                        exports.socketEmit(ws_to, {\n                            callback: true,\n                            status: \"in-progress\",\n                            data: data\n                        });\n                    };\n                    return [4 /*yield*/, deploy_1.deploy.info(callback)];\n                case 7:\n                    _b.sent();\n                    exports.socketEmit(ws_to, {\n                        callback: true,\n                        status: \"started\"\n                    });\n                    return [3 /*break*/, 20];\n                case 8:\n                    console.log(\"deploy_master_client\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    callback = function (data) {\n                        exports.socketEmit(ws_to, {\n                            callback: true,\n                            status: \"in-progress\",\n                            data: data\n                        });\n                    };\n                    return [4 /*yield*/, deploy_1.deploy.deploy(callback)];\n                case 9:\n                    _b.sent();\n                    exports.socketEmit(ws_to, {\n                        callback: true,\n                        status: \"started\"\n                    });\n                    return [3 /*break*/, 20];\n                case 10:\n                    console.log(\"inspect_master_client\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    callback = function (data) {\n                        exports.socketEmit(ws_to, {\n                            callback: true,\n                            status: \"in-progress\",\n                            data: data\n                        });\n                    };\n                    return [4 /*yield*/, deploy_1.deploy.inspect(callback)];\n                case 11:\n                    _b.sent();\n                    exports.socketEmit(ws_to, {\n                        callback: true,\n                        status: \"started\"\n                    });\n                    return [3 /*break*/, 20];\n                case 12:\n                    console.log(\"log_master_client\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    callback = function (data) {\n                        exports.socketEmit(ws_to, {\n                            callback: true,\n                            status: \"in-progress\",\n                            data: data\n                        });\n                    };\n                    return [4 /*yield*/, deploy_1.deploy.log(callback)];\n                case 13:\n                    _b.sent();\n                    exports.socketEmit(ws_to, {\n                        callback: true,\n                        status: \"started\"\n                    });\n                    return [3 /*break*/, 20];\n                case 14:\n                    console.log(\"dump_log_master_client\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    callback = function (data) {\n                        exports.socketEmit(ws_to, {\n                            callback: true,\n                            status: \"in-progress\",\n                            data: data\n                        });\n                    };\n                    return [4 /*yield*/, deploy_1.deploy.dump_log(callback)];\n                case 15:\n                    _b.sent();\n                    exports.socketEmit(ws_to, {\n                        callback: true,\n                        status: \"started\"\n                    });\n                    return [3 /*break*/, 20];\n                case 16:\n                    console.log(\"start_master_client\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    callback = function (data) {\n                        exports.socketEmit(ws_to, {\n                            callback: true,\n                            status: \"in-progress\",\n                            data: data\n                        });\n                    };\n                    return [4 /*yield*/, deploy_1.deploy.start(callback)];\n                case 17:\n                    _b.sent();\n                    exports.socketEmit(ws_to, {\n                        callback: true,\n                        status: \"started\"\n                    });\n                    return [3 /*break*/, 20];\n                case 18:\n                    console.log(\"stop_master_client\", payload[\"from\"], payload[\"channel\"]);\n                    // broadcast to all sockets in the channel\n                    id = payload[\"from\"];\n                    ws_to = sockets[id];\n                    callback = function (data) {\n                        exports.socketEmit(ws_to, {\n                            callback: true,\n                            status: \"in-progress\",\n                            data: data\n                        });\n                    };\n                    return [4 /*yield*/, deploy_1.deploy.stop(callback)];\n                case 19:\n                    _b.sent();\n                    exports.socketEmit(ws_to, {\n                        callback: true,\n                        status: \"started\"\n                    });\n                    return [3 /*break*/, 20];\n                case 20: return [2 /*return*/];\n            }\n        });\n    }); }\n};\n// module.exports = helpers;\n\n\n//# sourceURL=webpack://play-platform-relay/./src/server/socket.ts?");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = require("axios");;

/***/ }),

/***/ "body-parser":
/*!******************************!*\
  !*** external "body-parser" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("body-parser");;

/***/ }),

/***/ "bugsnag":
/*!**************************!*\
  !*** external "bugsnag" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("bugsnag");;

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");;

/***/ }),

/***/ "compression":
/*!******************************!*\
  !*** external "compression" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("compression");;

/***/ }),

/***/ "cookie-parser":
/*!********************************!*\
  !*** external "cookie-parser" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("cookie-parser");;

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("dotenv");;

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("express");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");;

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");;

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");;

/***/ }),

/***/ "lodash":
/*!*************************!*\
  !*** external "lodash" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("lodash");;

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");;

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");;

/***/ }),

/***/ "serve-index":
/*!******************************!*\
  !*** external "serve-index" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("serve-index");;

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("uuid");;

/***/ }),

/***/ "ws":
/*!*********************!*\
  !*** external "ws" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("ws");;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/server/server.ts");
/******/ 	
/******/ })()
;